package bayes

import (
	"fmt"
	"testing"
)

// Test against R:LearningBayes
func TestDiscHPI(t *testing.T) {
	x := []float64{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}
	p := []float64{0.0282475249, 0.1210608210, 0.2334744405, 0.2668279320, 0.2001209490, 0.1029193452, 0.0367569090, 0.0090016920, 0.0014467005, 0.0001377810, 0.0000059049}
	pcontent := 0.8

	probExact, hpiSet := DiscHPI(x, p, pcontent)
	fmt.Println("DiscHPI probExact :", probExact)
	fmt.Println("should be 0.8214841")
	fmt.Println("DiscHPI hpiSet :", hpiSet)
	fmt.Println("should be [1 2 3 4]")
	fmt.Println()
	fmt.Println()
	fmt.Println()
	fmt.Println()
}

func TestDiscHPI2(t *testing.T) {
	x := []float64{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100}
	p := []float64{1.995076e-06, 2.798110e-05, 1.942565e-04, 8.899916e-04, 3.026936e-03, 8.150982e-03, 1.810038e-02, 3.408970e-02, 5.558039e-02, 7.968424e-02, 1.016996e-01, 1.167010e-01, 1.213917e-01, 1.152481e-01, 1.004455e-01, 8.076873e-02, 6.017938e-02, 4.170457e-02, 2.697085e-02, 1.632527e-02, 9.273016e-03, 4.954470e-03, 2.495210e-03, 1.186805e-03, 5.340285e-04, 2.276898e-04, 9.211640e-05, 3.540874e-05, 1.294735e-05, 4.508383e-06, 1.496454e-06, 4.739203e-07, 1.433210e-07, 4.142003e-08, 1.144753e-08, 3.027563e-09, 7.666720e-10, 1.859916e-10, 4.324698e-11, 9.642473e-12, 2.062357e-12, 4.232887e-13, 8.339595e-14, 1.577648e-14, 2.866406e-15, 5.002864e-16, 8.389365e-17, 1.351856e-17, 2.093489e-18, 3.115900e-19, 4.457477e-20, 6.129069e-21, 8.100144e-22, 1.028877e-22, 1.255953e-23, 1.473241e-24, 1.660366e-25, 1.797576e-26, 1.869103e-27, 1.866105e-28, 1.788439e-29, 1.644788e-30, 1.451070e-31, 1.227543e-32, 9.953231e-34, 7.731411e-35, 5.750272e-36, 4.092588e-37, 2.785535e-38, 1.811820e-39, 1.125341e-40, 6.668875e-42, 3.767243e-43, 2.026582e-44, 1.037055e-45, 5.042193e-47, 2.326223e-48, 1.016898e-49, 4.205486e-51, 1.642545e-52, 6.047169e-54, 2.094125e-55, 6.805309e-57, 2.069892e-58, 5.875204e-60, 1.551063e-61, 3.794267e-63, 8.563319e-65, 1.774224e-66, 3.355097e-68, 5.751231e-70, 8.863901e-72, 1.216144e-73, 1.467228e-75, 1.532404e-77, 1.357396e-79, 9.915414e-82, 5.734620e-84, 2.462098e-86, 6.975986e-89, 9.783881e-92}
	pcontent := .95

	probExact, hpiSet := DiscHPI(x, p, pcontent)
	fmt.Println("DiscHPI probExact :", probExact)
	fmt.Println("should be 0.9525642")
	fmt.Println("DiscHPI hpiSet :", hpiSet)
	fmt.Println("should be [6  7  8  9 10 11 12 13 14 15 16 17 18]")

}
